!function(){function t(t,e,i,n){Object.defineProperty(t,e,{get:i,set:n,enumerable:!0,configurable:!0})}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},n={},r=e.parcelRequire7b01;null==r&&((r=function(t){if(t in i)return i[t].exports;if(t in n){var e=n[t];delete n[t];var r={id:t,exports:{}};return i[t]=r,e.call(r.exports,r,r.exports),r.exports}var a=Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(t,e){n[t]=e},e.parcelRequire7b01=r);var a=r.register;a("5fy9m",function(t,e){var i=r("bB0zn"),n=r("6QEWP"),a=r("2Xzd1"),o=function(){function t(e){(0,i._)(this,t),this.direction={up:"up",down:"down",left:"left",right:"right"},this.gameStatus={idle:"idle",playing:"playing",win:"win",lose:"lose"},this.initialField=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.cellMax=0,this.fieldSize=4,this.isAvailableMovement=!0,this.status=this.gameStatus.idle,this.isCustomInitial=!!e,this.defaultState=e||this.initialField}return(0,n._)(t,[{key:"moveLeft",value:function(){this.status=this.gameStatus.playing,this.sumGameFieldByRow(this.direction.left)}},{key:"moveRight",value:function(){this.status=this.gameStatus.playing,this.sumGameFieldByRow(this.direction.right)}},{key:"moveUp",value:function(){this.status=this.gameStatus.playing,this.sumGameFieldByColumn(this.direction.up)}},{key:"moveDown",value:function(){this.status=this.gameStatus.playing,this.sumGameFieldByColumn(this.direction.down)}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.state=this.isCustomInitial&&this.initialCustomState.length===this.fieldSize?this.initialCustomState:this.initialField,this.status=this.gameStatus.playing,this.generateRandomCellOnField(2)}},{key:"restart",value:function(){this.isCustomInitial?this.state=this.defaultState:(this.state=this.initialField,this.generateRandomCellOnField(2)),this.score=0,this.status=this.gameStatus.idle}},{key:"gMaxCell",value:function(){return this.cellMax}},{key:"getMoveAvailability",value:function(){return this.isAvailableMovement}},{key:"getMaxValueCell",value:function(t){var e;return(e=Math).max.apply(e,(0,a._)(t.flat()))}},{key:"getRandomCellValue",value:function(){return .9>Math.random()?2:4}},{key:"getRandomCellIndex",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.fieldSize;return{row:Math.floor(Math.random()*t),col:Math.floor(Math.random()*t)}}},{key:"sumRow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.fieldSize,i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=!1,r=0;if(i){var o=t.reduceRight(function(t,e,i){if(!e)return t;var o=t[0];return e!==o||n?[e].concat((0,a._)(t)):(n=!0,r=2*o,[2*o].concat((0,a._)(t.slice(1))))},[]);return{row:4===o.length?o:(0,a._)(Array(e-o.length).fill(0)).concat((0,a._)(o)),summCollapsed:r}}var s=t.reduce(function(t,e,i){return e?0===i?(t.push(e),t):e!==t[t.length-1]||n?(0,a._)(t).concat([e]):(n=!0,r=2*t.slice(-1),(0,a._)(t.slice(0,-1)).concat([2*t.slice(-1)])):t},[]);return{row:4===s.length?s:(0,a._)(s).concat((0,a._)(Array(e-s.length).fill(0))),summCollapsed:r}}},{key:"transposeField",value:function(t){return t.reduce(function(t,e){return e.forEach(function(e,i){t[i]=(0,a._)(t[i]||[]).concat([e])}),t},[])}},{key:"compareGameField",value:function(t,e){return JSON.stringify(t)===JSON.stringify(e)}},{key:"getAvailabilityMovement",value:function(t){var e=this,i=0;return!!t.flat().includes(0)||(t.forEach(function(t){var n=e.sumRow(t,e.fieldSize,e.direction.left).summCollapsed,r=e.sumRow(t,e.fieldSize,e.direction.right).summCollapsed;i+=n+r}),this.transposeField(t).forEach(function(t){var n=e.sumRow(t,e.fieldSize,e.direction.up).summCollapsed,r=e.sumRow(t,e.fieldSize,e.direction.down).summCollapsed;i+=n+r}),i>0)}},{key:"sumGameFieldByRow",value:function(t){var e=this,i=this.state,n=this.fieldSize,r=this.score||0,a=i.map(function(i){var a=e.sumRow(i,n,t===e.direction.right),o=a.row,s=a.summCollapsed;return r+=s,o});this.compareGameField(i,a)||(this.score=r,this.state=a,this.cellMax=this.getMaxValueCell(a),this.generateRandomCellOnField())}},{key:"sumGameFieldByColumn",value:function(t){var e=this,i=this.state,n=this.fieldSize,r=this.score||0,a=this.transposeField(i).map(function(i){var a=e.sumRow(i,n,t===e.direction.down),o=a.row,s=a.summCollapsed;return r+=s,o});this.compareGameField(i,a)||(this.score=r,this.state=this.transposeField(a),this.cellMax=this.getMaxValueCell(a),this.generateRandomCellOnField())}},{key:"generateRandomCellOnField",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=JSON.parse(JSON.stringify(this.state)),i=0;i<t;i++){for(var n=this.getRandomCellIndex(),r=this.getRandomCellValue();e[n.row][n.col];)n=this.getRandomCellIndex();e[n.row][n.col]=r}this.state=e,this.isAvailableMovement=this.getAvailabilityMovement(e)}}]),t}();t.exports=o}),a("bB0zn",function(e,i){t(e.exports,"_",function(){return n});function n(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}}),a("6QEWP",function(e,i){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}t(e.exports,"_",function(){return r})}),a("2Xzd1",function(e,i){t(e.exports,"_",function(){return l});var n=r("gUOYc"),a=r("Q6yVl"),o=r("4S8xA"),s=r("ihB7G");function l(t){return(0,n._array_without_holes)(t)||(0,a._iterable_to_array)(t)||(0,s._unsupported_iterable_to_array)(t)||(0,o._non_iterable_spread)()}}),a("gUOYc",function(e,i){t(e.exports,"_array_without_holes",function(){return a});var n=r("gNF1f");function a(t){if(Array.isArray(t))return(0,n._array_like_to_array)(t)}}),a("gNF1f",function(e,i){t(e.exports,"_array_like_to_array",function(){return n});function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}}),a("Q6yVl",function(e,i){t(e.exports,"_iterable_to_array",function(){return n});function n(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}}),a("4S8xA",function(e,i){t(e.exports,"_non_iterable_spread",function(){return n});function n(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}}),a("ihB7G",function(e,i){t(e.exports,"_unsupported_iterable_to_array",function(){return a});var n=r("gNF1f");function a(t,e){if(t){if("string"==typeof t)return(0,n._array_like_to_array)(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return(0,n._array_like_to_array)(t,e)}}}),document.addEventListener("DOMContentLoaded",function(){var t=new(r("5fy9m")),e=document.querySelector(".button"),i=function(){return t.getStatus()},n=document.querySelector(".message-start"),a=document.querySelector(".message-win"),o=document.querySelector(".message-lose"),s=document.querySelector(".game-score"),l=document.querySelectorAll(".field-row"),u=[];l.forEach(function(t){u.push(t.querySelectorAll(".field-cell"))});var c=function(){t.restart(),h(),a.classList.add("hidden"),o.classList.add("hidden")},d=function(){e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart"},f=function(){e.classList.remove("restart"),e.classList.add("start"),e.textContent="Start"},h=function(){var e=t.getState(),i=t.gMaxCell(),n=t.getMoveAvailability();s.textContent=t.getScore();for(var r=0;r<u.length;r++)for(var l=u[r],c=0;c<l.length;c++){var d=e[r][c],f=l[c];f.textContent="",f.className="field-cell",d&&(f.textContent=d,f.className="field-cell field-cell--".concat(d))}2048===i&&(document.removeEventListener("keydown",m),a.classList.remove("hidden")),n||(document.removeEventListener("keydown",m),o.classList.remove("hidden"))},m=function(e){switch("playing"===i()&&d(),e.key){case"ArrowLeft":t.moveLeft(),h();break;case"ArrowRight":t.moveRight(),h();break;case"ArrowUp":t.moveUp(),h();break;case"ArrowDown":t.moveDown(),h()}};e.addEventListener("click",function(e){e.preventDefault();var r=e.target.classList.contains("restart"),a=e.target.classList.contains("start");"playing"===i()&&r&&(c(),f(),document.addEventListener("keydown",m)),"playing"===i()&&a&&(c(),h()),"idle"===i()&&a&&(t.start(),e.currentTarget.blur(),n.classList.add("hidden"),h(),document.addEventListener("keydown",m))})})}();
//# sourceMappingURL=index.0c859cf3.js.map
